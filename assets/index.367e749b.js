var e=Object.defineProperty,t=("undefined"!=typeof require&&require,(t,s,i)=>(((t,s,i)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i})(t,"symbol"!=typeof s?s+"":s,i),i));import{P as s}from"./phaser.d8885fe6.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const i=12.8,a=180,l=8,r=1.08,o=220,h=50,c=3,d=800,n=2,u=300;class p extends s.GameObjects.Text{constructor(e,t,s,i,a){super(e,t,s,"",a),this.score=i,this.setText(this.scoreText)}get scoreText(){return`Score: ${this.score}`}setScore(e){this.score=e,this.setText(this.scoreText)}add(e){this.score+=e,this.setText(this.scoreText)}}class y extends s.GameObjects.Text{constructor(e,t,s,i,a){super(e,t,s,"",a),this.lives=i,this.setText(this.livesText)}get livesText(){return`Lives: ${this.lives}`}get isDead(){return this.lives<1}setLives(e){this.lives=e,this.setText(this.livesText)}removeLife(){this.setLives(this.lives-1)}}class b extends s.GameObjects.Text{constructor(e,t,s,i,a){super(e,t,s,"",a),this.clearedNum=i,this.setText(this.clearedText)}get clearedText(){return`Cleared: ${this.clearedNum}`}setClearedNum(e){this.clearedNum=e,this.setText(this.clearedText)}addClear(){this.clearedNum+=1,this.setText(this.clearedText)}}const m=50,v=20,g={row:3,col:7},f={top:50,left:60},x=10;class L extends s.Scene{constructor(){super("game-scene"),t(this,"ballHitPaddle",(()=>{this.sound.play("paddleHit"),this.ball.anims.play("wobble",!0)})),t(this,"ballHitBrick",((e,t)=>{const s=t;s.disableBody(!0,!1),this.sound.play("brickHit"),this.tweens.add({targets:s,alpha:{from:1,to:0},ease:"Linear",duration:u,repeat:0,yoyo:!1,onComplete:()=>s.disableBody(!0,!0)});const i=this.timesCleared>0?n*this.timesCleared:1,a=h*i;this.scoreLabel.add(a),0===this.bricks.countActive(!0)&&this.resetLevel()})),this.canvas=null,this.ball=null,this.bricks=null,this.cursors=null,this.velocity=0,this.scoreLabel=null,this.livesLabel=null,this.clearedLabel=null,this.timesCleared=0,this.isPlaying=!1,this.startButton=null,this.enterKey=null}preload(){this.canvas=this.sys.game.canvas,this.load.spritesheet("ball","img/wobble.png",{frameWidth:20,frameHeight:20}),this.load.image("paddle","img/paddle.png"),this.load.image("brick","img/brick.png"),this.load.spritesheet("button","img/button.png",{frameWidth:120,frameHeight:40}),this.load.audio("paddleHit","audio/114187__edgardedition__thud17.wav"),this.load.audio("brickHit","audio/478284__joao-janz__finger-tap-2-2.wav")}create(){this.startButton=this.createStartButton(),this.ball=this.createBall(),this.paddle=this.createPaddle(),this.physics.add.collider(this.ball,this.paddle,this.ballHitPaddle),this.bricks=this.createBricks(),this.physics.add.collider(this.ball,this.bricks,this.ballHitBrick),this.scoreLabel=this.createScoreLabel(8,8,0),this.livesLabel=this.createLivesLabel(140,8,c),this.clearedLabel=this.createClearedLabel(240,8,0),this.cursors=this.input.keyboard.createCursorKeys(),this.startButton.on("pointerdown",this.startGame,this),this.enterKey=this.input.keyboard.addKey(s.Input.Keyboard.KeyCodes.ENTER),this.physics.world.on("worldbounds",this.detectBounds,this)}update(){const e=this.cursors.space.isDown,t=this.enterKey.isDown;!e&&!t||this.isPlaying||this.startGame(),this.cursors.left.isDown?this.velocity-=i:this.cursors.right.isDown?this.velocity+=i:(this.velocity>0?this.velocity-=l:this.velocity+=l,this.velocity<1.1*l&&(this.velocity=0)),Math.abs(this.velocity)>a&&(this.velocity=a*Math.sign(this.velocity)),this.isPlaying?this.paddle.setVelocityX(this.velocity):this.paddle.body.velocity.x>0&&this.paddle.setVelocityX(0)}createStartButton(){const e=this.add.sprite(.5*this.canvas.width,.5*this.canvas.height,"button");return e.setInteractive(),e}createBall(){const e=this.physics.add.sprite(.5*this.canvas.width,this.canvas.height-25,"ball");e.setOrigin(.5);const t=[0,1,0,2,0,1,0,2,0].map((e=>({key:"ball",frame:e})));return this.anims.create({key:"wobble",frames:t,frameRate:24}),e.body.setCollideWorldBounds(!0,1,1,!0),e.setBounce(1),e.setMaxVelocity(o,o),e}createPaddle(){const e=.5*this.canvas.width,t=this.canvas.height-5,s=this.physics.add.sprite(e,t,"paddle").setOrigin(.5,1);return s.setCollideWorldBounds(),s.setImmovable(),s}createBricks(){const e=this.physics.add.staticGroup();for(let t=0;t<g.col;t++)for(let s=0;s<g.row;s++){const i=(m+x)*t+f.left,a=(v+x)*s+f.top;e.create(i,a,"brick")}return e}createScoreLabel(e,t,s){const i=new p(this,e,t,s,{fontSize:"20px",fontFamily:"Ariel",strokeThickness:1,color:"#eee",stroke:"#0095DD"});return this.add.existing(i),i}createLivesLabel(e,t,s){const i=new y(this,e,t,s,{fontSize:"20px",fontFamily:"Ariel",strokeThickness:1,color:"#eee",stroke:"#0095DD"});return this.add.existing(i),i}createClearedLabel(e,t,s){const i=new b(this,e,t,s,{fontSize:"20px",fontFamily:"Ariel",strokeThickness:1,color:"#eee",stroke:"#0095DD"});return this.add.existing(i),i}startGame(){this.isPlaying=!0,this.startButton.setActive(!1).setVisible(!1),this.scoreLabel.setScore(0),this.livesLabel.setLives(c),this.timesCleared=0,this.clearedLabel.setClearedNum(0),this.setBallVelocity(),this.resetBallPaddlePosition()}setBallVelocity(){const e=this.timesCleared>0?Math.pow(r,this.timesCleared):1;this.ball.setVelocity(150*e,-150*e)}stopBallVelocity(){this.ball.setVelocity(0,0)}detectBounds(e,t,s,i,a){s&&(this.livesLabel.removeLife(),this.livesLabel.isDead?(this.resetLevel(),this.gameOver()):(this.resetBallPaddlePosition(),this.physics.pause(),this.time.delayedCall(d,this.resumeGame,null,this)))}resetBallPaddlePosition(){const e=.5*this.canvas.width,t=this.canvas.height-this.paddle.height-this.ball.height;this.ball.setPosition(e,t),this.paddle.setPosition(.5*this.canvas.width,this.paddle.y)}resumeGame(){this.physics.resume()}resetLevel(){this.physics.pause(),this.clearedLabel.addClear(),this.timesCleared+=1,this.setBallVelocity(),this.resetBallPaddlePosition(),this.time.delayedCall(d,(()=>{this.repopulateBricks(),this.resumeGame()}))}repopulateBricks(){this.bricks.children.iterate((e=>{const t=e;t.enableBody(!0,t.x,t.y,!0,!0),t.clearAlpha()}))}gameOver(){this.isPlaying=!1,this.startButton.setActive(!0).setVisible(!0),this.stopBallVelocity()}}const B=document.querySelector("#app");new s.Game({type:s.CANVAS,parent:B,width:480,height:320,scale:{mode:s.Scale.FIT,autoCenter:s.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{}},scene:[L]});
